(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/liupishui-pickerpolygons/liupishui-pickerpolygons"],{"6aab":function(t,e,i){"use strict";(function(t){var o=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,a,s=o(i("448a")),l=i("9a2a"),c={props:{polygons:{type:Array,default:[{points:[{latitude:"36.829066",longitude:"118.025761"},{latitude:"36.825012",longitude:"118.066702"},{latitude:"36.81161",longitude:"118.042681"},{latitude:"36.801964",longitude:"118.034875"}],strokeWidth:1,strokeColor:"#ff000066",fillColor:"#ff000016"},{points:[{latitude:"36.817369",longitude:"118.001311"},{latitude:"36.808682",longitude:"118.010281"},{latitude:"36.805555",longitude:"117.996537"}],strokeWidth:1,strokeColor:"#ff000066",fillColor:"#ff000016"}]},qqmapsdkKey:{type:String,default:""},base_url:{type:String,default:""},sig:{type:String,default:""}},data:function(){return{canConfirm:!0,animateLocation:!1,isChangeSelectItem:!1,searchKey:"",position:{latitude:"36.811995",longitude:"118.05539"},searchlist:[]}},mounted:function(){if(""!=this.qqmapsdkKey){n=new l({key:this.qqmapsdkKey,BASE_URL:this.base_url});var e=this,i=!0;if(t.getStorageSync("mapPickerPosition")){var o=JSON.parse(t.getStorageSync("mapPickerPosition"));(new Date).getTime()<o.expireTime&&(i=!1,e.position.latitude=o.position.latitude,e.position.longitude=o.position.longitude,e.init())}i&&t.getLocation({cacheTimeout:1,accuracy:"best",type:"gcj02",isHighAccuracy:!0,success:function(i){console.log(i),e.position.latitude=i.latitude,e.position.longitude=i.longitude,t.setStorageSync("mapPickerPosition",JSON.stringify({expireTime:(new Date).getTime()-0+6e4,position:{latitude:i.latitude,longitude:i.longitude}})),e.init()},fail:function(t){console.log(t)}})}else console.error("需要腾讯地图开发Key，申请地址：https://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/jsSdkOverview")},methods:{init:function(){var t=this;this.animateLocation=!0,a=setTimeout((function(){t.renderList()}),400)},renderList:function(){var e=this,i=t.createMapContext("map_20221212",e);i.getCenterLocation({success:function(t){var i={location:t.latitude+","+t.longitude,get_poi:1,poi_options:"radius=1000",sig:e.sig,success:function(t){var i=!1;if("query ok"==t.message){e.$data.searchlist=(0,s.default)(t.result.pois);for(var o=0;o<e.$data.searchlist.length;o++){e.$data.searchlist.useable=!0,e.$data.searchlist.select=!1;for(var n=0;n<e.polygons.length;n++)e.isPointInPolygon(e.$data.searchlist[o].location.lat,e.$data.searchlist[o].location.lng,e.polygons[n].points)&&(e.$data.searchlist[o].useable=!0,i||(e.$data.searchlist[o].select=!0,i=!0))}setTimeout((function(){e.animateLocation=!1}),200)}e.canConfirm=!0},fail:function(t){console.log(t)}};"undefined"===typeof window&&delete i.sig,""===i.sig&&delete i.sig,n.reverseGeocoder(i)}})},searchPosition:function(){if(""!=this.searchKey.replace(/\s+/,"")){var t=this,e={keyword:this.searchKey,location:{latitude:this.position.latitude,longitude:this.position.longitude},sig:t.sig,success:function(e){var i=!1;if("query ok"==e.message){t.$data.searchlist=(0,s.default)(e.data);for(var o=0;o<t.$data.searchlist.length;o++){t.$data.searchlist.useable=!0,t.$data.searchlist.select=!1;for(var n=0;n<t.polygons.length;n++)t.isPointInPolygon(t.$data.searchlist[o].location.lat,t.$data.searchlist[o].location.lng,t.polygons[n].points)&&(t.$data.searchlist[o].useable=!0,i||(t.$data.searchlist[o].select=!0,t.position.latitude=t.$data.searchlist[o].location.lat,t.position.longitude=t.$data.searchlist[o].location.lng,i=!0))}}t.canConfirm=!0}};"undefined"===typeof window&&delete e.sig,""===e.sig&&delete e.sig,n.search(e)}},changeSelectItem:function(t){for(var e=0;e<this.$data.searchlist.length;e++){var i={};for(var o in this.$data.searchlist[e])i[o]=this.$data.searchlist[e][o];e===t?(i.select=!0,this.isChangeSelectItem=!0,this.position.latitude=i.location.lat,this.position.longitude=i.location.lng):i.select=!1,this.$set(this.$data.searchlist,e,i)}},handleRegionchange:function(t){var e=this;if(console.log(t),this.animateLocation=!1,"end"==t.type){if(this.isChangeSelectItem)return void setTimeout((function(){e.isChangeSelectItem=!1}),100);this.animateLocation=!0,a&&clearTimeout(a),a=setTimeout((function(){e.renderList()}),400)}},isPointInPolygon:function(t,e,i){return!0},confirmSelect:function(){var e=this;this.canConfirm&&this.searchlist.forEach((function(i){i.select&&(i.polygonIndex=[],e.polygons.forEach((function(t,o){e.isPointInPolygon(i.location.lat,i.location.lng,t.points)&&i.polygonIndex.push(o)})),t.setStorageSync("polygonLocationPicker",JSON.stringify(i)),e.$emit("selected",JSON.stringify(i)))}))}}};e.default=c}).call(this,i("543d")["default"])},7545:function(t,e,i){},"9a07":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},n=[]},"9e01":function(t,e,i){"use strict";i.r(e);var o=i("6aab"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},bd3d:function(t,e,i){"use strict";var o=i("7545"),n=i.n(o);n.a},ef52:function(t,e,i){"use strict";i.r(e);var o=i("9a07"),n=i("9e01");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("bd3d");var s=i("f0c5"),l=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"e051d006",null,!1,o["a"],void 0);e["default"]=l.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/liupishui-pickerpolygons/liupishui-pickerpolygons-create-component',
    {
        'components/liupishui-pickerpolygons/liupishui-pickerpolygons-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("ef52"))
        })
    },
    [['components/liupishui-pickerpolygons/liupishui-pickerpolygons-create-component']]
]);
